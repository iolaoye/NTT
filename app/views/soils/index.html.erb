<% case %>
	<% when notice %>
		<div class="success_alert">
		<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
		<%= notice %>
	  </div>
	<% when flash[:info] %>
		<div class="flash_alert">
		<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
		<%= flash[:info] %>
	  </div>
<% end %>

<div class="page-header"><h1><%= t("menu.soils") %></h1></div>

<%= form_for [@project, @field] do |f| %>
  <% if @field.errors.any? %>
    <div id="error_explanation">
      <h2><%= t('activerecord.form_errors', :count => @field.errors.count, :model => t('models.field').downcase) %></h2>

      <ul>
      <% @field.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field" title="Name of Field">
    <%= f.label t('field.field_name') %>
    <%= f.text_field :field_name %>
  </div>
  <div class="field" title="Field Area (Ac.). Must be greater than 0.">
    <%= f.label t('field.field_area') %>
    <%= f.number_field :field_area, :class => 'numbers', :step => "any" %>
  </div>
  <div class="field">
  <%= f.label t('field.field_avg_slope') %>
    <%= f.number_field :field_average_slope, :class => 'numbers', :step => "any", disabled: true  %>  <a href="#" id="trigger">[?]</a>
  </div>
  <div class="field">
    <%#= f.label t('field.field_type') %>
	<%# if @field.field_name.include?(ROAD) || @field.field_name.include?(SMZ) %>
		<%#= f.check_box :field_type, disabled: true %>
	<%# else %>
		<%#= f.check_box :field_type %>
	<%# end %>
  </div>
    <% unless ENV["APP_VERSION"] == "modified" %>
   <div class="field">
    <%= f.label t('field.coordinate') + " (long, lat)" %><br>
    <%= f.text_area :coordinates, :required => 'true', disabled: true %>
  </div><% end %>
  <div class="actions">
    <%= f.submit 'Save and Continue', :class => "btn btn-primary" %>
<br><br>
  </div>

<div id="pop-up">
  TODO: add explanation of how average slope is calculated and why it is not editable
</div>

<% end %>

<script>
  $(function() {
  var moveLeft = -300;
  var moveDown = -100;
  $('a#trigger').hover(function(e) {
    $('div#pop-up').show();
  }, function() {
    $('div#pop-up').hide();
  });
  $('a#trigger').mousemove(function(e) {
    $("div#pop-up").css('top', e.pageY + moveDown).css('left', e.pageX + moveLeft);
  });
});
    </script>



<% unless ENV["APP_VERSION"] == "modified" %><%= link_to t('soil.new'), new_project_field_soil_path(@project, @field), :class => 'btn btn-primary' %><% end %>

<% if ENV["APP_VERSION"] == "modified" %>
<div class="table-responsive">
  <div class="panel panel-default">
    <table class="table table-striped">
      <thead>
        <tr>
          <th class="gvCellStyleTitle"><%= t('soil.selected') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.symbol') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.group') %></th> 
          <th class="gvCellStyleTitle"><%= t('soil.name') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.albedo') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.slope') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.percentage') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.drainage') %></th>
          <th class="gvCellStyleTitle"><%= t('general.actions') %></th>
        </tr>
      </thead>
    
	  <tbody>
			  <% i=1 %>
				<% @soils.each do |soil| %>
				<% if (i % 2 == 0) %>
					<tr class="gvRowStyleEven">
				<% else %>
					<tr class="gvRowStyleOdd">
				<% end %>
					<td class="gvCellStyleCheckbox"><%= check_box_tag :soil, "1", soil.selected, disabled: true %></td>
					<td class="gvCellStyleText"><%= soil.symbol %></td>
					<td class="gvCellStyleText"><%= soil.group %></td>
					<td class="gvCellStyleText"><%= soil.name %></td>
					<td class="gvCellStyleNumber"><%= soil.albedo %></td>
					<td class="gvCellStyleNumber"><%= soil.slope %></td>
					<td class="gvCellStyleNumber"><%= soil.percentage %></td>
					<td class="gvCellStyleText"><%= Drainage.find(soil.drainage_id).name %></td>
					<td class="gvCellStyleActions">
						<%= link_to image_tag("layers.png"), project_field_soil_layers_path(@project, @field, soil), title: t('soil.layers') %>  <%#http://www.veryicon.com/search/soil+layers/%>
						<%= link_to image_tag("delete.png"), project_field_soil_path(@project, @field, soil), title: t('general.delete'), method: :delete, data: { confirm: t('general.confirm') }%>
					</td>
				</tr>
  			    <% i = i + 1 %>
			  <% end %>
	  </tbody>
	</table></div>
  </div>
<br>

<% else %>
<div class="table-responsive">
  <div class="panel panel-default">
    <table class="table table-striped">
      <thead>
        <tr>
          <th class="gvCellStyleTitle"><%= t('soil.selected') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.symbol') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.group') %></th> 
          <th class="gvCellStyleTitle"><%= t('soil.name') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.albedo') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.slope') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.percentage') %></th>
          <th class="gvCellStyleTitle"><%= t('soil.drainage') %></th>
          <th class="gvCellStyleTitle"><%= t('general.actions') %></th>
        </tr>
      </thead>
    
	  <tbody>
			  <% i=1 %>
				<% @soils.each do |soil| %>
				<% if (i % 2 == 0) %>
					<tr class="gvRowStyleEven">
				<% else %>
					<tr class="gvRowStyleOdd">
				<% end %>
					<td class="gvCellStyleCheckbox"><%= check_box_tag :soil, "1", soil.selected, disabled: true %></td>
					<td class="gvCellStyleText"><%= soil.symbol %></td>
					<td class="gvCellStyleText"><%= soil.group %></td>
					<td class="gvCellStyleText"><%= soil.name %></td>
					<td class="gvCellStyleNumber"><%= soil.albedo %></td>
					<td class="gvCellStyleNumber"><%= soil.slope %></td>
					<td class="gvCellStyleNumber"><%= soil.percentage %></td>
					<td class="gvCellStyleText"><%= Drainage.find(soil.drainage_id).name %></td>
					<td class="gvCellStyleActions">
						<%= link_to image_tag("layers.png"), project_field_soil_layers_path(@project, @field, soil), title: t('soil.layers') %>  <%#http://www.veryicon.com/search/soil+layers/%>
						<%= link_to image_tag("edit.png"), edit_project_field_soil_path(@project, @field, soil), title: t('general.edit')%>
						<%= link_to image_tag("delete.png"), project_field_soil_path(@project, @field, soil), title: t('general.delete'), method: :delete, data: { confirm: t('general.confirm') }%>
					</td>
				</tr>
  			    <% i = i + 1 %>
			  <% end %>
	  </tbody>
	</table></div>
  </div>
<br>
<% end %>