<div class="panel panel-default">
	<table class='table table-bordered', style="white-space: nowrap;">
	  	<thead> <!-- titles -->
		  	<tr class='gvHeaderStyle' >
		  		<th></th>
		  		<% if session[:simulation] == 'scenario' %>
					<% if @scenario1 == "0" || @scenario1 == "" %> <th style="text-align:center"><%= t('result.scenario1') %></th> <% else %> <th style="text-align:center"><%=Scenario.find(@scenario1).name%></th><%end%>
					<% if @scenario2 == "0" || @scenario2 == ""  %> <th colspan="2" style="text-align:center"><%= t('result.scenario2') %></th> <% else %> <th colspan="2" style="text-align:center"><%=Scenario.find(@scenario2).name%></th><%end%>
					<% if @scenario3 == "0" || @scenario3 == ""  %> <th colspan="2" style="text-align:center"><%= t('result.scenario3') %></th> <% else %> <th colspan="2" style="text-align:center"><%=Scenario.find(@scenario3).name%></th><%end%>
				<% else %>
					<% if @scenario1 == "0" || @scenario1 == ""  %> <th style="text-align:center"><%= t('result.scenario1') %></th> <% else %> <th style="text-align:center"><%=Watershed.find(@scenario1).name%></th><%end%>
					<% if @scenario2 == "0" || @scenario2 == ""  %> <th colspan="2" style="text-align:center"><%= t('result.scenario1') %></th> <% else %> <th colspan="2" style="text-align:center"><%=Watershed.find(@scenario2).name%></th><%end%>
					<% if @scenario3 == "0" || @scenario3 == ""  %> <th colspan="2" style="text-align:center"><%= t('result.scenario3') %></th> <% else %> <th colspan="2" style="text-align:center"><%=Watershed.find(@scenario3).name%></th><%end%>
				<% end %>
		  	</tr>
			<tr class='gvHeaderStyle'>
				<th style="border-right: thick double #ff0000" ><%= t('result.description') %></th>
				<th ><%= "Losses(±)" %></th>
				<th ><%= "Losses(±)" %></th>
				<th style="border-right: thick double #ff0000"><%= t('general.change') + "(%)"%></th>
				<th ><%= "Losses(±)" %></th>
				<th ><%= t('general.change') + "(%)"%></th>
			</tr>
	  	</thead>
	  	<tbody>
	  		<% t = "t" %>
				<% row_id = t + "row" + "20" %>
				<% @id = "scenario_id" %>
				<% if session[:simulation] != "scenario" then %>
					<% @id = "watershed_id" %>
				<% end %>
				<% if @scenario1 != "0" then %>
					<% total_area = @total_area1 %>
					<% if @scenario2 != "0" && @scenario2 != "" then %>
						<% total_area = @total_area2 %>
						<% if @scenario3 != "0" && @scenario3 != ""  then %>
							<% total_area = @total_area3 %>
						<% end %>
					<% end %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Total N" + " (" + "lbs" + ")" %>
							<%= check_box_tag "Total N" %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][0]+@totals1[0][1]+@totals1[0][2]+@totals1[0][3]) + " (" + sprintf("%8.2f", @cis1[0][1]+@cis1[0][2]+@cis1[0][3]+@cis1[0][4]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][0]+@totals2[0][1]+@totals2[0][2]+@totals2[0][3]) + " (" + sprintf("%8.1f", @cis2[0][1]+@cis2[0][2]+@cis2[0][3]+@cis2[0][4]) + ")" %></td>
							<% difference1 = @totals2[0][0]+@totals2[0][1]+@totals2[0][2]+@totals2[0][3]-(@totals1[0][0]+@totals1[0][1]+@totals1[0][2]+@totals1[0][3]) %>
							<% reduction1 = difference1 / (@totals1[0][0]+@totals1[0][1]+@totals1[0][2]+@totals1[0][3]) * 100 %>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][0]+@totals3[0][1]+@totals3[0][2]+@totals3[0][3]).to_s + " (" + sprintf("%8.1f", @cis3[0][1]+@cis3[0][2]+@cis3[0][3]+@cis3[0][4]) + ")" %></td>
							<% difference1 = @totals3[0][0]+@totals3[0][1]+@totals3[0][2]+@totals3[0][3]-(@totals1[0][0]+@totals1[0][1]+@totals1[0][2]+@totals1[0][3]) %>
							<% reduction1 = difference1 / (@totals1[0][0]+@totals1[0][1]+@totals1[0][2]+@totals1[0][3]) * 100 %>
							<td class= "gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.1f", difference1).to_s + " (" + sprintf("%8.1f", reduction1).to_s + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "21" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Org N" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][0]) + " (" + sprintf("%8.1f", @cis1[0][1]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][0]) + " (" + sprintf("%8.1f", @cis2[0][1]) + ")" %></td>
							<td class=<%= if @totals2[0][0]-@totals1[0][0] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][0]-@totals1[0][0]) + " (" + sprintf("%8.2f", ((@totals2[0][0]-@totals1[0][0]) / @totals1[0][0]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][0]) + " (" + sprintf("%8.1f", @cis3[0][1]) + ")" %></td>
							<td class=<%= if @totals3[0][0]-@totals1[0][0] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][0]-@totals1[0][0]) + " (" + sprintf("%8.2f", ((@totals3[0][0]-@totals1[0][0]) / @totals1[0][0]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "22" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Runoff N" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][1]) + " (" + sprintf("%8.1f", @cis1[0][2]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][1]) + " (" + sprintf("%8.1f", @cis2[0][2]) + ")" %></td>
							<td class=<%= if @totals2[0][1]-@totals1[0][1] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][1]-@totals1[0][1]) + " (" + sprintf("%8.2f", ((@totals2[0][1]-@totals1[0][1]) / @totals1[0][1]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][1]) + " (" + sprintf("%8.1f", @cis3[0][2]) + ")" %></td>
							<td class=<%= if @totals3[0][1]-@totals1[0][1] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][1]-@totals1[0][1]) + " (" + sprintf("%8.2f", ((@totals3[0][1]-@totals1[0][1]) / @totals1[0][1]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "23" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Subsurface N" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][2]).to_s + " (" + sprintf("%8.1f", @cis1[0][3]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][2]) + " (" + sprintf("%8.1f", @cis2[0][3]) + ")" %></td>
							<td class=<%= if @totals2[0][2]-@totals1[0][2] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][2]-@totals1[0][2]).to_s + " (" + sprintf("%8.2f", ((@totals2[0][2]-@totals1[0][2]) / @totals1[0][2]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][2]) + " (" + sprintf("%8.1f", @cis3[0][3]) + ")" %></td>
							<td class=<%= if @totals3[0][2]-@totals1[0][2] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][2]-@totals1[0][2]) + " (" + sprintf("%8.2f", ((@totals3[0][2]-@totals1[0][2]) / @totals1[0][2]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "24" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Tile Drain N" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][3]).to_s + " (" + sprintf("%8.1f", @cis1[0][4]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][3]-@totals1[0][3]) + " (" + sprintf("%8.1f", @cis2[0][4]) + ")" %></td>
							<td class=<%= if @totals2[0][3]-@totals1[0][3] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][3]-@totals1[0][3]).to_s + " (" + sprintf("%8.1f", ((@totals2[0][3]-@totals1[0][3]) / @totals1[0][3]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][3]-@totals1[0][3]).to_s + " (" + sprintf("%8.1f", @cis3[0][4]) + ")" %></td>
							<td class=<%= if @totals3[0][3]-@totals1[0][3] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][3]-@totals1[0][3]).to_s + " (" + sprintf("%8.1f", ((@totals3[0][3]-@totals1[0][3]) / @totals1[0][3]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<%# P values %>
					<% row_id = t + "row" + "30" %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Total P" + " (" + "lbs" + ")" %>
							<%= check_box_tag "Total P" %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][4]+@totals1[0][5]+@totals1[0][6]).to_s + " (" + sprintf("%8.1f", @cis1[0][5]+@cis1[0][6]+@cis1[0][7]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][4]+@totals2[0][5]+@totals2[0][6]) + " (" + sprintf("%8.1f", @cis2[0][5]+@cis2[0][6]+@cis2[0][7]) + ")" %></td>
							<% difference1 = @totals2[0][4]+@totals2[0][5]+@totals2[0][6]-(@totals1[0][4]+@totals1[0][5]+@totals1[0][6]) %>
							<% reduction1 = difference1 / (@totals1[0][4]+@totals1[0][5]+@totals1[0][6]) * 100 %>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][4]+@totals3[0][5]+@totals3[0][6]) + " (" + sprintf("%8.1f", @cis3[0][5]+@cis3[0][6]+@cis3[0][7]) + ")" %></td>
							<% difference1 = @totals3[0][4]+@totals3[0][5]+@totals3[0][6]-(@totals1[0][4]+@totals1[0][5]+@totals1[0][6]) %>
							<% reduction1 = difference1 / (@totals1[0][4]+@totals1[0][5]+@totals1[0][5]) * 100 %>
							<td class= "gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.1f", difference1).to_s + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "31" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Org P" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][4]) + " (" + sprintf("%8.1f", @cis1[0][5]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][4]) + " (" + sprintf("%8.1f", @cis2[0][5]) + ")" %></td>
							<td class=<%= if @totals2[0][4]-@totals1[0][4] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][4]-@totals1[0][4]).to_s + " (" + sprintf("%8.2f", ((@totals2[0][4]-@totals1[0][4]) / @totals1[0][4]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][4]) + " (" + sprintf("%8.1f", @cis3[0][5]) + ")" %></td>
							<td class=<%= if @totals3[0][4]-@totals1[0][4] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][4]-@totals1[0][4]).to_s + " (" + sprintf("%8.2f", ((@totals3[0][4]-@totals1[0][4]) / @totals1[0][4]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "32" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "PO4" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][5]) + " (" + sprintf("%8.1f", @cis1[0][6]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][5]) + " (" + sprintf("%8.1f", @cis2[0][6]) + ")" %></td>
							<td class=<%= if @totals2[0][5]-@totals1[0][5] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][5]-@totals1[0][5]) + " (" + sprintf("%8.2f", ((@totals2[0][5]-@totals1[0][5]) / @totals1[0][5]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals2[0][5]) + " (" + sprintf("%8.1f", @cis3[0][6]) + ")" %></td>
							<td class=<%= if @totals3[0][5]-@totals1[0][5] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][5]-@totals1[0][5]) + " (" + sprintf("%8.2f", ((@totals3[0][5]-@totals1[0][5]) / @totals1[0][5]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "33" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Tile Drain P" + " (" + "lbs" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][6]) + " (" + sprintf("%8.1f", @cis1[0][7]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][6]) + " (" + sprintf("%8.1f", @cis2[0][7]) + ")" %></td>
							<td class=<%= if @totals2[0][6]-@totals1[0][6] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][6]-@totals1[0][6]) + " (" + sprintf("%8.2f", ((@totals2[0][6]-@totals1[0][6]) / @totals1[0][6]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][6]) + " (" + sprintf("%8.1f", @cis3[0][7]) + ")" %></td>
							<td class=<%= if @totals3[0][6]-@totals1[0][6] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][6]-@totals1[0][6]).to_s + " (" + sprintf("%8.2f", ((@totals3[0][6]-@totals1[0][6]) / @totals1[0][6]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<%# Flow values %>
					<% row_id = t + "row" + "40" %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Surface/Subsurface/Tile Drain Flow" + " (" + "acre-in" + ")" %>
							<%= check_box_tag "Total P" %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][7]+@totals1[0][8]+@totals1[0][9]) + " (" + sprintf("%8.1f", @cis1[0][8]+@cis1[0][9]+@cis1[0][10]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][7]+@totals2[0][8]+@totals2[0][9]) + " (" + sprintf("%8.1f", @cis2[0][8]+@cis2[0][9]+@cis2[0][10]) + ")" %></td>
							<% difference1 = @totals2[0][7]+@totals2[0][8]+@totals2[0][9]-(@totals1[0][7]+@totals1[0][8]+@totals1[0][9]) %>
							<% reduction1 = difference1 / (@totals1[0][7]+@totals1[0][8]+@totals1[0][9]) * 100 %>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1).to_s + ")" %></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][7]+@totals3[0][8]+@totals3[0][9]) + " (" + sprintf("%8.1f", @cis3[0][8]+@cis3[0][9]+@cis3[0][10]) + ")" %></td>
							<% difference1 = @totals3[0][7]+@totals3[0][8]+@totals3[0][9]-(@totals1[0][7]+@totals1[0][8]+@totals1[0][9]) %>
							<% reduction1 = difference1 / (@totals1[0][7]+@totals1[0][8]+@totals1[0][9]) * 100 %>
							<td class= "gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.1f", difference1).to_s + " (" + sprintf("%8.1f", reduction1).to_s + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "41" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Surface Flow" + " (" + "acre-in" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][7]) + " (" + sprintf("%8.1f", @cis1[0][8]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][7]) + " (" + sprintf("%8.1f", @cis2[0][8]) + ")" %></td>
							<td class=<%= if @totals2[0][7]-@totals1[0][7] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][7]-@totals1[0][7]) + " (" + sprintf("%8.2f", ((@totals2[0][7]-@totals1[0][7]) / @totals1[0][7]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][7]) + " (" + sprintf("%8.1f", @cis3[0][8]) + ")" %></td>
							<td class=<%= if @totals3[0][7]-@totals1[0][7] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][7]-@totals1[0][7]).to_s + " (" + sprintf("%8.2f", ((@totals3[0][7]-@totals1[0][7]) / @totals1[0][7]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "42" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Subsurface Flow" + " (" + "acre-in" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][8]) + " (" + sprintf("%8.1f", @cis1[0][9]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][8]) + " (" + sprintf("%8.1f", @cis2[0][9]) + ")" %></td>
							<td class=<%= if @totals2[0][8]-@totals1[0][8] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][8]-@totals1[0][8]) + " (" + sprintf("%8.2f", ((@totals2[0][8]-@totals1[0][8]) / @totals1[0][8]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][8]) + " (" + sprintf("%8.1f", @cis3[0][9]) + ")" %></td>
							<td class=<%= if @totals3[0][8]-@totals1[0][8] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][8]-@totals1[0][8]) + " (" + sprintf("%8.2f", ((@totals3[0][8]-@totals1[0][8]) / @totals1[0][8]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "43" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Tile Drain Flow" + " (" + "acre-in" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][9]).to_s + " (" + sprintf("%8.1f", @cis1[0][10]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][9]) + " (" + sprintf("%8.1f", @cis2[0][10]) + ")" %></td>
							<td class=<%= if @totals2[0][9]-@totals1[0][9] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][9]-@totals1[0][9]).to_s + " (" + sprintf("%8.2f", ((@totals2[0][9]-@totals1[0][9]) / @totals1[0][9]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][9]).to_s + " (" + sprintf("%8.1f", @cis3[0][10]) + ")" %></td>
							<td class=<%= if @totals3[0][9]-@totals1[0][9] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][9]-@totals1[0][9]).to_s + " (" + sprintf("%8.2f", ((@totals3[0][9]-@totals1[0][9]) / @totals1[0][9]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<%# Other Flow values %>
					<% row_id = t + "row" + "50" %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Total Other Water Info" + " (" + "acre-in" + ")" %>
							<%= check_box_tag "Total P" %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][10]+@totals1[0][11]) + " (" + sprintf("%8.1f", @cis1[0][11]+@cis1[0][12]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][10]+@totals2[0][11]) + " (" + sprintf("%8.1f", @cis2[0][11]+@cis2[0][12]) + ")" %></td>
							<% difference1 = @totals2[0][10]+@totals2[0][11]-(@totals1[0][10]+@totals1[0][11]) %>
							<% reduction1 = difference1 / (@totals1[0][10]+@totals1[0][11]) * 100 %>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][10]+@totals3[0][11]) + " (" + sprintf("%8.1f", @cis3[0][11]+@cis3[0][12]) + ")" %></td>
							<% difference1 = @totals3[0][10]+@totals3[0][11]-(@totals1[0][10]+@totals1[0][11]) %>
							<% reduction1 = difference1 / (@totals1[0][10]+@totals1[0][11]) * 100 %>
							<td class= "gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "51" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Irrigation Runoff" + " (" + "acre-in" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][10]) + " (" + sprintf("%8.1f", @cis1[0][11]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][10]) + " (" + sprintf("%8.1f", @cis2[0][11]) + ")" %></td>
							<td class=<%= if @totals2[0][10]-@totals1[0][10] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][10]-@totals1[0][10]) + " (" + sprintf("%8.2f", ((@totals2[0][10]-@totals1[0][10]) / @totals1[0][10]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][10]) + " (" + sprintf("%8.1f", @cis3[0][11]) + ")" %></td>
							<td class=<%= if @totals3[0][10]-@totals1[0][10] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][10]-@totals1[0][10]) + " (" + sprintf("%8.2f", ((@totals3[0][10]-@totals1[0][10]) / @totals1[0][10]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "52" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Deep Percolation" + " (" + "acre-in" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][11]) + " (" + sprintf("%8.1f", @cis1[0][12]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][11]) + " (" + sprintf("%8.1f", @cis2[0][12]) + ")" %></td>
							<td class=<%= if @totals2[0][11]-@totals1[0][11] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][11]-@totals1[0][11]) + " (" + sprintf("%8.2f", ((@totals2[0][11]-@totals1[0][11]) / @totals1[0][11]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][11]) + " (" + sprintf("%8.1f", @cis3[0][12]) + ")" %></td>
							<td class=<%= if @totals3[0][11]-@totals1[0][11] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][11]-@totals1[0][11]) + " (" + sprintf("%8.2f", ((@totals3[0][11]-@totals1[0][11]) / @totals1[0][11]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<%# Erosion %>
					<% row_id = t + "row" + "60" %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Total Sediment" + " (" + "t" + ")" %>
							<%= check_box_tag "Total P" %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.2f", @totals1[0][12]+@totals1[0][13]) + " (" + sprintf("%8.1f", @cis1[0][13]+@cis1[0][14]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"><%= sprintf("%8.2f", @totals2[0][12]+@totals2[0][13]) + " (" + sprintf("%8.1f", @cis2[0][13]+@cis2[0][14]) + ")" %></td>
							<% difference1 = @totals2[0][12]+@totals2[0][13]-(@totals1[0][12]+@totals1[0][13]) %>
							<% reduction1 = difference1 / (@totals1[0][12]+@totals1[0][13]) * 100 %>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.2f", @totals3[0][12]+@totals3[0][13]) + " (" + sprintf("%8.1f", @cis2[0][13]+@cis2[0][14]) + ")" %></td>
							<% difference1 = @totals3[0][12]+@totals3[0][13]-(@totals1[0][12]+@totals1[0][13]) %>
							<% reduction1 = difference1 / (@totals1[0][12]+@totals1[0][13]) * 100 %>
							<td class= "gvTotalText" style="background-color:#CADCFF"><%= sprintf("%8.1f", difference1) + " (" + sprintf("%8.1f", reduction1) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "61" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Surface Erosion" + " (" + "t" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.4f", @totals1[0][12]) + " (" + sprintf("%8.1f", @cis1[0][13]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.4f", @totals2[0][12]) + " (" + sprintf("%8.1f", @cis2[0][13]) + ")" %></td>
							<td class=<%= if @totals2[0][12]-@totals1[0][12] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.4f", @totals2[0][12]-@totals1[0][12]) + " (" + sprintf("%8.2f", ((@totals2[0][12]-@totals1[0][12]) / @totals1[0][12]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.4f", @totals3[0][12]) + " (" + sprintf("%8.1f", @cis3[0][13]) + ")" %></td>
							<td class=<%= if @totals3[0][12]-@totals1[0][12] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.4f", @totals3[0][12]-@totals1[0][12]) + " (" + sprintf("%8.2f", ((@totals3[0][12]-@totals1[0][12]) / @totals1[0][12]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<% row_id = t + "row" + "62" %>
					<tr class="gvRowStyleEven" id = <%=row_id%> style="display:none">
						<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= "Manure Erosion" + " (" + "t" + ")" %></th>
						<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf("%8.4f", @totals1[0][13]).to_s + " (" + sprintf("%8.1f", @cis1[0][14]) + ")" %></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf("%8.4f", @totals2[0][13]) + " (" + sprintf("%8.1f", @cis2[0][14]) + ")" %></td>
							<td class=<%= if @totals2[0][13]-@totals1[0][13] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.4f", @totals2[0][13]-@totals1[0][13]) + " (" + sprintf("%8.2f", ((@totals2[0][13]-@totals1[0][13]) / @totals1[0][13]) * 100) + ")" %></td>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf("%8.4f", @totals3[0][13]) + " (" + sprintf("%8.1f", @cis3[0][14]) + ")" %></td>
							<td class=<%= if @totals3[0][13]-@totals1[0][13] <= 0 then "nutrients_positive bottom_border" else "nutrients_negative bottom_border" end %> style="background-color:#CADCFF"><%= sprintf("%8.4f", @totals3[0][13]-@totals1[0][13]) + " (" + sprintf("%8.2f", ((@totals3[0][13]-@totals1[0][13]) / @totals1[0][13]) * 100) + ")" %></td>
						<% end %>
					</tr>
					<%# Crops %>
					<% row_id = t + "row" + "70" %>
					<tr class="gvRowStyleOdd", id = <%=row_id%>>
						<th class="gvTotalText" style="border-right: thick double #ff0000; text-align:left">
							<%= "Crop Yield"  %>
							<%= check_box_tag "Crop Yield",1, {:checked => "checked"} %>
						</th>
						<td class="gvTotalText" style="border-right: thick double #ff0000; background-color:#FFE8F9"></td>
						<% if @scenario2 != "0" && @scenario2 != "" then %>
							<td class="gvTotalText" style="background-color:#DEFFFD"></td>
							<td class= "gvTotalText" style="border-right: thick double #ff0000; background-color:#DEFFFD"></td>
						<% end %>
						<% if @scenario3 > "0" then %>
							<td class="gvTotalText" style="background-color:#CADCFF"></td>
							<td class= "gvTotalText" style="background-color:#CADCFF"></td>
						<% end %>
					</tr>
					<%# Determine the number of crops to list them and the stress values %>
					<% i = 1 %>
					<% crop_results = Array.new %>
					<% @crops1.each do |cr1| %>
						<% crop_result = Hash.new %>
						<% crop_result["name"] = cr1[5] %>
						<% crop_result["yield1"] = cr1[0] * @total_area1 %>
						<% if @cic1.assoc(cr1[5]) != nil %>
							<% crop_result["ci1"] = @cic1.assoc(cr1[5])[1] %>
						<% else %>
							<% crop_result["ci1"] = 0 %>
						<% end %>						
						<% crop_result["ws1"] = cr1[1].round(0) %>
						<% crop_result["ns1"] = cr1[2].round(0) %>
						<% crop_result["ps1"] = cr1[3].round(0) %>
						<% crop_result["ts1"] = cr1[4].round(0) %>
						<% crop_result["yield2"] = 0 %>
						<% crop_result["ci2"] = 0 %>
						<% crop_result["ws2"] = 0 %>
						<% crop_result["ns2"] = 0 %>
						<% crop_result["ps2"] = 0 %>
						<% crop_result["ts2"] = 0 %>
						<% crop_result["yield3"] = 0 %>
						<% crop_result["ci3"] = 0 %>
						<% crop_result["ws3"] = 0 %>
						<% crop_result["ns3"] = 0 %>
						<% crop_result["ps3"] = 0 %>
						<% crop_result["ts3"] = 0 %>
						<% if @scenario2 != "0" && @scenario2 != "" then%>
							<% @crops2.each do |cr2| %>
								<% if cr2[5] == cr1[5] then %>
									<% crop_result["yield2"] = cr2[0] * @total_area2%>
									<% if @cic2.assoc(cr2[5]) != nil %>
										<% crop_result["ci2"] = @cic2.assoc(cr2[5])[1] %>
									<% else %>
										<% crop_result["ci2"] = 0 %>
									<% end %>
									<% crop_result["ws2"] = cr2[1].round(0) %>
									<% crop_result["ns2"] = cr2[2].round(0) %>
									<% crop_result["ps2"] = cr2[3].round(0) %>
									<% crop_result["ts2"] = cr2[4].round(0) %>
								<% end %>
							<% end %>
						<% end %>
						<% if @scenario3 != "0" && @scenario3 != "" then%>
							<% @crops3.each do |cr3| %>
								<% if cr3[5] == cr1[5] then %>
									<% crop_result["yield3"] = cr3[0] * @total_area3 %>
									<% if @cic3.assoc(cr3[5]) != nil %>
										<% crop_result["ci3"] = @cic3.assoc(cr3[5])[1] %>
									<% else %>
										<% crop_result["ci3"] = 0 %>
									<% end %>
									<% crop_result["ws3"] = cr3[1].round(0) %>
									<% crop_result["ns3"] = cr3[2].round(0) %>
									<% crop_result["ps3"] = cr3[3].round(0) %>
									<% crop_result["ts3"] = cr3[4].round(0) %>
								<% end %>
							<% end %>
						<% end %>
						<% crop_results.push(crop_result) %>
					<% end %>
			<%# will find out if there are new crops in scenario 2 %>
			<% if @scenario2 != "0" && @scenario2 != "" then %>
				<% @crops2.each do |cr2| %>
					<% found = false %>
					<% @crops1.each do |cr1|%>
						<% if cr2[5] == cr1[5] then %>
							<% found = true %>
							<% break %>
						<% end %>
					<% end %>
					<% if found == false then %>   <%# this is a new crop and needs to be added to the list %>
						<% crop_result = Hash.new %>
						<% crop_result["name"] = cr2[5] %>
						<% crop_result["yield1"] = 0 %>
						<% crop_result["ci1"] = 0 %>
						<% crop_result["ws1"] = 0 %>
						<% crop_result["ns1"] = 0 %>
						<% crop_result["ps1"] = 0 %>
						<% crop_result["ts1"] = 0 %>
						<% crop_result["yield2"] = cr2[0] * @total_area2 %>
						<% if @cic2.assoc(cr2[5]) != nil %>
							<% crop_result["ci2"] = @cic2.assoc(cr2[5])[1] %>
						<% else %>
							<% crop_result["ci2"] = 0 %>
						<% end %>
						<% crop_result["ws2"] = cr2[1] %>
						<% crop_result["ns2"] = cr2[2] %>
						<% crop_result["ps2"] = cr2[3] %>
						<% crop_result["ts2"] = cr2[4] %>
						<% crop_result["yield3"] = 0 %>
						<% crop_result["ci3"] = 0 %>
						<% crop_result["ws3"] = 0 %>
						<% crop_result["ns3"] = 0 %>
						<% crop_result["ps3"] = 0 %>
						<% crop_result["ts3"] = 0 %>
						<% if @scenario3 != "0" && @scenario3 != "" then %>
							<% @crops3.each do |cr3| %>
								<% if cr3[5] == cr2[5] then %>
									<% crop_result["yield3"] = cr3[0] * @total_area3 %>
									<% if @cic3.assoc(cr3[5]) != nil %>
										<% crop_result["ci3"] = @cic3.assoc(cr3[5])[1] %>
									<% else %>
										<% crop_result["ci3"] = 0 %>
									<% end %>
									<% crop_result["ws3"] = cr3[1] %>
									<% crop_result["ns3"] = cr3[2] %>
									<% crop_result["ps3"] = cr3[3] %>
									<% crop_result["ts3"] = cr3[4] %>
								<% end %>
							<% end %>
						<% end %>
						<% crop_results.push(crop_result) %>
					<% end %>
				<% end %>
			<% end %>
			<%# will find out if there are new crops in scenario 3 %>
			<% if @scenario3 != "0" && @scenario3 != "" then %>
				<% @crops3.each do |cr3| %>
					<% found = false %>
					<% crop_results.each do |cr|%>
						<% if cr3[5] == cr["name"] then %>
							<% found = true %>
							<% break %>
						<% end %>
					<% end %>
					<% if found == false then %>   <%# this is a new crop and needs to be added to the list %>
						<% crop_result = Hash.new %>
						<% crop_result["name"] = cr3[5] %>
						<% crop_result["yield1"] = 0 %>
						<% crop_result["ci1"] = 0 %>
						<% crop_result["ws1"] = 0 %>
						<% crop_result["ns1"] = 0 %>
						<% crop_result["ps1"] = 0 %>
						<% crop_result["ts1"] = 0 %>
						<% crop_result["yield2"] = 0 %>
						<% crop_result["ci2"] = 0 %>
						<% crop_result["ws2"] = 0 %>
						<% crop_result["ns2"] = 0 %>
						<% crop_result["ps2"] = 0 %>
						<% crop_result["ts2"] = 0 %>
						<% crop_result["yield3"] = cr3[0] * @total_area3 %>
						<% if @cic3.assoc(cr3[5]) != nil %>
							<% crop_result["ci3"] = @cic3.assoc(cr3[5])[1] %>
						<% else %>
							<% crop_result["ci3"] = 0 %>
						<% end %>
						<% crop_result["ws3"] = cr3[1] %>
						<% crop_result["ns3"] = cr3[2] %>
						<% crop_result["ps3"] = cr3[3] %>
						<% crop_result["ts3"] = cr3[4] %>
						<% crop_results.push(crop_result) %>
					<% end %>
				<% end %>
			<% end %>
			<% crop_results.each do |cr| %>
				<%# get conversion unit dry matter to calculate yield and also take the unts %>
				<% crop = Crop.find_by_code(cr["name"]) %>
			    <% conversion_factor = 1 * AC_TO_HA %>
			    <% dry_matter = 100 %>
			    <% unit = "t" %>
				<% if crop != nil then %>
			      <% conversion_factor = crop.conversion_factor * AC_TO_HA %>
			      <% dry_matter = crop.dry_matter %>
			      <% unit = crop.yield_unit  %>
				<% end %>
				<% if unit == "t" %>
					<% format1 = "%8.2f" %>
				<% else %>
					<% format1 = "%8.0f" %>
				<% end %>
				<% row_id = t + "row" + (70 + i).to_s %>
				<tr class="gvRowStyleEven" id = <%=row_id%> style="display:''">
					<th class="gvDetailText bottom_border" style="border-right: thick double #ff0000"><%= crop.name + " (" + unit + ")" %></th>
					<td class="gvCellStyleNumber bottom_border" style="border-right: thick double #ff0000; background-color:#FFE8F9"><%= sprintf(format1, cr["yield1"] * conversion_factor / (dry_matter/100)) + " (" + sprintf("%8.1f", cr["ci1"]) + ")" %></td>
					<% if @scenario2 != "0" && @scenario2 != "" then %>
						<td class="gvCellStyleNumber bottom_border" style="background-color:#DEFFFD"><%= sprintf(format1, cr["yield2"] * conversion_factor / (dry_matter/100)).to_s + " (" + sprintf("%8.1f", cr["ci2"]) + ")" %></td>
						<td class=<%= if cr["yield2"]-cr["yield1"] <= 0 then "nutrients_negative bottom_border" else "nutrients_positive bottom_border" end %> style="border-right: thick double #ff0000; background-color:#DEFFFD"><%= sprintf("%8.2f", cr["yield2"]-cr["yield1"]) + " (" + sprintf(format1, (cr["yield2"]-cr["yield1"]) * 100 / cr["yield1"]) + ")" unless cr["yield1"]==0 %></td>
					<% end %>
					<% if @scenario3 != "0" && @scenario3 != "" then %>
						<td class="gvCellStyleNumber bottom_border" style="background-color:#CADCFF"><%= sprintf(format1, cr["yield3"] * conversion_factor / (dry_matter/100)).to_s + " (" + sprintf("%8.1f", cr["ci3"]) + ")" %></td>
						<td class=<%= if cr["yield3"]-cr["yield1"] <= 0 then "nutrients_negative bottom_border" else "nutrients_positive bottom_border" end %> style="background-color:#CADCFF"><%= sprintf(format1, cr["yield3"]-cr["yield1"]) + " (" + sprintf("%8.2f", (cr["yield3"]-cr["yield1"] * 100) / cr["yield1"]) + ")" unless cr["yield1"]==0 %></td>
					<% end %>
				</tr>
				<% i += 1 %>
			<% end %>
			<% end %>
			<%# end %>   <!-- if @results1 != nil && @present -->
			<!--Crop result here -->
			<% id = 70%>
		</tbody>
	</table>
</div>
